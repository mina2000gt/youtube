解答 (ネタバレ注意)
Solution (warning: this is spoiler)

https://gist.github.com/mikecat/2c00dd2219d8a139c98a70580e72aed7
